<%- include('partials/head', { title: 'Edit Profile' }) %>

<div class="max-w-2xl mx-auto p-6">
  <div class="bg-card p-8 rounded-2xl shadow-md">
    <h1 class="text-2xl font-semibold mb-4">Edit Profile</h1>

    <form id="profileForm" action="/profile/update" method="POST" class="space-y-4">
      <div>
        <label class="block text-sm text-gray-300">Name</label>
        <input name="name" type="text" value="<%= user.name || '' %>" required
               class="w-full mt-1 p-3 rounded-lg bg-gray-800 text-gray-100 border border-gray-700" />
      </div>

      <div>
        <label class="block text-sm text-gray-300">Email</label>
        <input name="email" type="email" value="<%= user.email %>" <%= user.googleId ? 'readonly class=\"opacity-60 cursor-not-allowed\"' : '' %> required
               class="w-full mt-1 p-3 rounded-lg bg-gray-800 text-gray-100 border border-gray-700" />
        <% if (user.googleId) { %>
          <p class="text-xs text-gray-400 mt-1">Email berasal dari Google sign-in dan tidak dapat diubah.</p>
        <% } %>
      </div>

      <!-- Password section only for local users -->
      <% if (!user.googleId) { %>
      <div class="pt-2 border-t border-gray-700">
        <p class="text-sm text-gray-300 mb-2">Ubah Password (opsional)</p>

        <div>
          <label class="block text-sm text-gray-300">Current Password</label>
          <input name="currentPassword" type="password" autocomplete="current-password"
                 class="w-full mt-1 p-3 rounded-lg bg-gray-800 text-gray-100 border border-gray-700" />
        </div>

        <div>
          <label class="block text-sm text-gray-300 mt-2">New Password</label>
          <input name="newPassword" type="password" autocomplete="new-password"
                 class="w-full mt-1 p-3 rounded-lg bg-gray-800 text-gray-100 border border-gray-700" />
          <p class="text-xs text-gray-400 mt-1">Kosongkan jika tidak ingin mengganti password.</p>
        </div>
      </div>
      <% } %>

      <div class="flex gap-3 pt-4">
        <button type="submit" class="px-6 py-2 rounded-lg bg-gradient-to-r from-gray-700 to-gray-600">Save</button>
        <a href="/dashboard" class="px-4 py-2 rounded-lg border border-gray-700">Cancel</a>
      </div>
    </form>

    <% if (message) { %>
      <div class="mt-4 text-sm text-<%= messageType === 'error' ? 'red-400' : 'green-300' %>"><%= message %></div>
    <% } %>
  </div>
</div>

<%- include('partials/footer') %>
